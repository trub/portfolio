(function(e){var b=e.document.documentElement;function a(){var i=b.clientHeight,j=e.innerHeight;if(i<j){return j}else{return i}}function g(){return e.pageYOffset||b.scrollTop}function f(j){var i=0,k=0;do{if(!isNaN(j.offsetTop)){i+=j.offsetTop}if(!isNaN(j.offsetLeft)){k+=j.offsetLeft}}while(j=j.offsetParent);return{top:i,left:k}}function d(o,n){var m=o.offsetHeight,l=g(),j=l+a(),i=f(o).top,k=i+m,n=n||0;return(i+m*n)<=j&&(k-m*n)>=l}function h(j,i){for(var k in i){if(i.hasOwnProperty(k)){j[k]=i[k]}}return j}function c(j,i){this.el=j;this.options=h(this.defaults,i);this._init()}c.prototype={defaults:{minDuration:0,maxDuration:0,viewportFactor:0},_init:function(){this.items=Array.prototype.slice.call(document.querySelectorAll("#"+this.el.id+" > li"));this.itemsCount=this.items.length;this.itemsRenderedCount=0;this.didScroll=false;var i=this;imagesLoaded(this.el,function(){new Masonry(i.el,{itemSelector:"li",transitionDuration:0});if(Modernizr.cssanimations){i.items.forEach(function(k,j){if(d(k)){i._checkTotalRendered();classie.add(k,"shown")}});e.addEventListener("scroll",function(){i._onScrollFn()},false);e.addEventListener("resize",function(){i._resizeHandler()},false)}})},_onScrollFn:function(){var i=this;if(!this.didScroll){this.didScroll=true;setTimeout(function(){i._scrollPage()},60)}},_scrollPage:function(){var i=this;this.items.forEach(function(k,j){if(!classie.has(k,"shown")&&!classie.has(k,"animate")&&d(k,i.options.viewportFactor)){setTimeout(function(){var l=g()+a()/2;i.el.style.WebkitPerspectiveOrigin="50% "+l+"px";i.el.style.MozPerspectiveOrigin="50% "+l+"px";i.el.style.perspectiveOrigin="50% "+l+"px";i._checkTotalRendered();if(i.options.minDuration&&i.options.maxDuration){var m=(Math.random()*(i.options.maxDuration-i.options.minDuration)+i.options.minDuration)+"s";k.style.WebkitAnimationDuration=m;k.style.MozAnimationDuration=m;k.style.animationDuration=m}classie.add(k,"animate")},25)}});this.didScroll=false},_resizeHandler:function(){var i=this;function j(){i._scrollPage();i.resizeTimeout=null}if(this.resizeTimeout){clearTimeout(this.resizeTimeout)}this.resizeTimeout=setTimeout(j,1000)},_checkTotalRendered:function(){++this.itemsRenderedCount;if(this.itemsRenderedCount===this.itemsCount){e.removeEventListener("scroll",this._onScrollFn)}}};e.AnimOnScroll=c})(window);